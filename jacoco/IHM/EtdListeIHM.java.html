<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EtdListeIHM.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GestionDesEtudiants</a> &gt; <a href="index.source.html" class="el_package">IHM</a> &gt; <span class="el_source">EtdListeIHM.java</span></div><h1>EtdListeIHM.java</h1><pre class="source lang-java linenums">/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package IHM;

import Entite.Etudiant;
import Entite.etdClass;
import client.Client;
import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import com.itextpdf.text.*;
import com.itextpdf.text.pdf.*;
import java.io.File;
import java.io.FileOutputStream;
import java.text.SimpleDateFormat;
import java.util.Date;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Font;
import com.itextpdf.text.FontFactory;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;

/**
 *
 * @author Mohamed Hdilou
 */
public class EtdListeIHM extends javax.swing.JFrame {

private ArrayList&lt;etdClass&gt; classes; // Variable pour stocker les classes
    private Client client; // Variable pour stocker l'instance Client

    /**
     * Creates new form EtdListeIHM
     */
<span class="nc" id="L51">    public EtdListeIHM() throws RemoteException {</span>
<span class="nc" id="L52">        initComponents();</span>
<span class="nc" id="L53">        client = new Client();</span>
<span class="nc" id="L54">        chargerClasses();</span>
<span class="nc" id="L55">        chargerTableEtudiants();</span>
<span class="nc" id="L56">    }</span>

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    
    
    private void chargerClasses() throws RemoteException {
<span class="nc" id="L67">        classes = client.chargercmbClass();</span>
<span class="nc" id="L68">        DefaultComboBoxModel&lt;String&gt; model = new DefaultComboBoxModel&lt;&gt;();</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">        for (etdClass classe : classes) {</span>
<span class="nc" id="L70">            model.addElement(classe.getNomClasse()); // Afficher le nom de la classe</span>
<span class="nc" id="L71">        }</span>
<span class="nc" id="L72">        cmbClass.setModel(model);</span>
<span class="nc" id="L73">    }</span>
    
    
    private void chargerTableEtudiants() {
        try {
<span class="nc" id="L78">            ArrayList&lt;Etudiant&gt; etudiants = client.afficherEtudiants();</span>
<span class="nc" id="L79">            DefaultTableModel model = (DefaultTableModel) table.getModel();</span>
<span class="nc" id="L80">            model.setRowCount(0); // Effacer les anciennes données</span>

<span class="nc bnc" id="L82" title="All 2 branches missed.">            for (Etudiant etudiant : etudiants) {</span>
<span class="nc" id="L83">                Object[] row = {</span>
<span class="nc" id="L84">                    etudiant.getId(),</span>
<span class="nc" id="L85">                    etudiant.getNom(),</span>
<span class="nc" id="L86">                    etudiant.getPrenom(),</span>
<span class="nc" id="L87">                    etudiant.getEmail(),</span>
<span class="nc" id="L88">                    etudiant.getNomFiliere(), // Assurez-vous d'avoir ces getters dans votre classe Etudiant</span>
<span class="nc" id="L89">                    etudiant.getNomClasse()  // Assurez-vous d'avoir ces getters dans votre classe Etudiant</span>
                };
<span class="nc" id="L91">                model.addRow(row);</span>
<span class="nc" id="L92">            }</span>
<span class="nc" id="L93">        } catch (RemoteException ex) {</span>
<span class="nc" id="L94">            Logger.getLogger(GestionEtdIHM.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L95">            javax.swing.JOptionPane.showMessageDialog(this, &quot;Erreur de récupération des étudiants.&quot;, &quot;Erreur&quot;, javax.swing.JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L96">        }</span>
<span class="nc" id="L97">    }</span>
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {

<span class="nc" id="L101">        jPanel1 = new javax.swing.JPanel();</span>
<span class="nc" id="L102">        jScrollPane1 = new javax.swing.JScrollPane();</span>
<span class="nc" id="L103">        table = new javax.swing.JTable();</span>
<span class="nc" id="L104">        btnAfficherParClasse = new javax.swing.JButton();</span>
<span class="nc" id="L105">        cmbClass = new javax.swing.JComboBox&lt;&gt;();</span>
<span class="nc" id="L106">        jPanel2 = new javax.swing.JPanel();</span>
<span class="nc" id="L107">        jLabel2 = new javax.swing.JLabel();</span>
<span class="nc" id="L108">        jButton1 = new javax.swing.JButton();</span>
<span class="nc" id="L109">        txtSearch = new javax.swing.JTextField();</span>
<span class="nc" id="L110">        jLabel1 = new javax.swing.JLabel();</span>
<span class="nc" id="L111">        btnImprimer = new javax.swing.JButton();</span>

<span class="nc" id="L113">        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);</span>

<span class="nc" id="L115">        jPanel1.setBackground(new java.awt.Color(255, 255, 255));</span>

<span class="nc" id="L117">        table.setModel(new javax.swing.table.DefaultTableModel(</span>
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                &quot;CodeEtudiant&quot;, &quot;Nom&quot;, &quot;Prenom&quot;, &quot;Email&quot;, &quot;Filier&quot;, &quot;Classe&quot;
            }
<span class="nc" id="L127">        ) {</span>
<span class="nc" id="L128">            boolean[] canEdit = new boolean [] {</span>
                false, false, false, false, true, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
<span class="nc" id="L133">                return canEdit [columnIndex];</span>
            }
        });
<span class="nc" id="L136">        jScrollPane1.setViewportView(table);</span>

<span class="nc" id="L138">        btnAfficherParClasse.setBackground(new java.awt.Color(0, 153, 255));</span>
<span class="nc" id="L139">        btnAfficherParClasse.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 3, 12)); // NOI18N</span>
<span class="nc" id="L140">        btnAfficherParClasse.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L141">        btnAfficherParClasse.setText(&quot;Étudiants de la classe :&quot;);</span>
<span class="nc" id="L142">        btnAfficherParClasse.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L144">                btnAfficherParClasseActionPerformed(evt);</span>
<span class="nc" id="L145">            }</span>
        });

<span class="nc" id="L148">        cmbClass.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));</span>
<span class="nc" id="L149">        cmbClass.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L151">                cmbClassActionPerformed(evt);</span>
<span class="nc" id="L152">            }</span>
        });

<span class="nc" id="L155">        jPanel2.setBackground(new java.awt.Color(102, 204, 255));</span>

<span class="nc" id="L157">        jLabel2.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 1, 36)); // NOI18N</span>
<span class="nc" id="L158">        jLabel2.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L159">        jLabel2.setText(&quot;Consulter la liste des Etudiants&quot;);</span>

<span class="nc" id="L161">        jButton1.setBackground(new java.awt.Color(51, 204, 255));</span>
<span class="nc" id="L162">        jButton1.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 3, 36)); // NOI18N</span>
<span class="nc" id="L163">        jButton1.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L164">        jButton1.setText(&quot;&lt;&quot;);</span>
<span class="nc" id="L165">        jButton1.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L167">                jButton1ActionPerformed(evt);</span>
<span class="nc" id="L168">            }</span>
        });

<span class="nc" id="L171">        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);</span>
<span class="nc" id="L172">        jPanel2.setLayout(jPanel2Layout);</span>
<span class="nc" id="L173">        jPanel2Layout.setHorizontalGroup(</span>
<span class="nc" id="L174">            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L175">            .addGroup(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L176">                .addGap(24, 24, 24)</span>
<span class="nc" id="L177">                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L178">                .addGap(161, 161, 161)</span>
<span class="nc" id="L179">                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 545, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L180">                .addContainerGap(288, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L182">        jPanel2Layout.setVerticalGroup(</span>
<span class="nc" id="L183">            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L184">            .addGroup(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L185">                .addGap(17, 17, 17)</span>
<span class="nc" id="L186">                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)</span>
<span class="nc" id="L187">                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L188">                    .addComponent(jLabel2))</span>
<span class="nc" id="L189">                .addContainerGap(25, Short.MAX_VALUE))</span>
        );

<span class="nc" id="L192">        txtSearch.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L194">                txtSearchActionPerformed(evt);</span>
<span class="nc" id="L195">            }</span>
        });
<span class="nc" id="L197">        txtSearch.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyReleased(java.awt.event.KeyEvent evt) {
<span class="nc" id="L199">                txtSearchKeyReleased(evt);</span>
<span class="nc" id="L200">            }</span>
        });

<span class="nc" id="L203">        jLabel1.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 2, 12)); // NOI18N</span>
<span class="nc" id="L204">        jLabel1.setForeground(new java.awt.Color(153, 153, 153));</span>
<span class="nc" id="L205">        jLabel1.setText(&quot;rechercher un Etudiant par Nom :&quot;);</span>

<span class="nc" id="L207">        btnImprimer.setBackground(new java.awt.Color(102, 153, 255));</span>
<span class="nc" id="L208">        btnImprimer.setFont(new java.awt.Font(&quot;Segoe UI&quot;, 3, 14)); // NOI18N</span>
<span class="nc" id="L209">        btnImprimer.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L210">        btnImprimer.setText(&quot;Imprimer&quot;);</span>
<span class="nc" id="L211">        btnImprimer.setActionCommand(&quot;impirimer&quot;);</span>
<span class="nc" id="L212">        btnImprimer.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L214">                btnImprimerActionPerformed(evt);</span>
<span class="nc" id="L215">            }</span>
        });

<span class="nc" id="L218">        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);</span>
<span class="nc" id="L219">        jPanel1.setLayout(jPanel1Layout);</span>
<span class="nc" id="L220">        jPanel1Layout.setHorizontalGroup(</span>
<span class="nc" id="L221">            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L222">            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L223">                .addGap(0, 0, Short.MAX_VALUE)</span>
<span class="nc" id="L224">                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L225">                    .addComponent(jPanel2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L226">                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L227">                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L228">                            .addComponent(btnImprimer, javax.swing.GroupLayout.PREFERRED_SIZE, 233, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L229">                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)</span>
<span class="nc" id="L230">                                .addGroup(jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L231">                                    .addComponent(jLabel1)</span>
<span class="nc" id="L232">                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)</span>
<span class="nc" id="L233">                                    .addComponent(txtSearch, javax.swing.GroupLayout.PREFERRED_SIZE, 399, javax.swing.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L234">                                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 924, javax.swing.GroupLayout.PREFERRED_SIZE)))</span>
<span class="nc" id="L235">                        .addGap(79, 79, 79))))</span>
<span class="nc" id="L236">            .addGroup(jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L237">                .addGap(34, 34, 34)</span>
<span class="nc" id="L238">                .addComponent(btnAfficherParClasse, javax.swing.GroupLayout.PREFERRED_SIZE, 168, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L239">                .addGap(18, 18, 18)</span>
<span class="nc" id="L240">                .addComponent(cmbClass, javax.swing.GroupLayout.PREFERRED_SIZE, 168, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L241">                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L243">        jPanel1Layout.setVerticalGroup(</span>
<span class="nc" id="L244">            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L245">            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L246">                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L247">                .addGap(18, 18, 18)</span>
<span class="nc" id="L248">                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)</span>
<span class="nc" id="L249">                    .addComponent(cmbClass, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L250">                    .addComponent(btnAfficherParClasse))</span>
<span class="nc" id="L251">                .addGap(6, 6, 6)</span>
<span class="nc" id="L252">                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)</span>
<span class="nc" id="L253">                    .addComponent(txtSearch, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L254">                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L255">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="nc" id="L256">                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 412, Short.MAX_VALUE)</span>
<span class="nc" id="L257">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="nc" id="L258">                .addComponent(btnImprimer)</span>
<span class="nc" id="L259">                .addGap(19, 19, 19))</span>
        );

<span class="nc" id="L262">        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());</span>
<span class="nc" id="L263">        getContentPane().setLayout(layout);</span>
<span class="nc" id="L264">        layout.setHorizontalGroup(</span>
<span class="nc" id="L265">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L266">            .addGroup(layout.createSequentialGroup()</span>
<span class="nc" id="L267">                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L268">                .addGap(0, 0, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L270">        layout.setVerticalGroup(</span>
<span class="nc" id="L271">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L272">            .addGroup(layout.createSequentialGroup()</span>
<span class="nc" id="L273">                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L274">                .addGap(0, 0, Short.MAX_VALUE))</span>
        );

<span class="nc" id="L277">        pack();</span>
<span class="nc" id="L278">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

    private void btnAfficherParClasseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAfficherParClasseActionPerformed
        try {
            // Récupérer la classe sélectionnée dans la combobox
<span class="nc" id="L283">            int idClasse = classes.get(cmbClass.getSelectedIndex()).getIdClasse();</span>

            // Récupérer les étudiants de la classe sélectionnée
<span class="nc" id="L286">            ArrayList&lt;Etudiant&gt; etudiants = client.afficherEtudiantsParClasse(idClasse);</span>

            // Effacer le tableau actuel
<span class="nc" id="L289">            DefaultTableModel model = (DefaultTableModel) table.getModel();</span>
<span class="nc" id="L290">            model.setRowCount(0);</span>

            // Ajouter les étudiants au tableau
<span class="nc bnc" id="L293" title="All 2 branches missed.">            for (Etudiant etudiant : etudiants) {</span>
<span class="nc" id="L294">                Object[] row = {</span>
<span class="nc" id="L295">                    etudiant.getId(),</span>
<span class="nc" id="L296">                    etudiant.getNom(),</span>
<span class="nc" id="L297">                    etudiant.getPrenom(),</span>
<span class="nc" id="L298">                    etudiant.getEmail(),</span>
<span class="nc" id="L299">                    etudiant.getNomFiliere(),</span>
<span class="nc" id="L300">                    etudiant.getNomClasse()</span>
                };
<span class="nc" id="L302">                model.addRow(row);</span>
<span class="nc" id="L303">            }</span>
<span class="nc" id="L304">        } catch (RemoteException ex) {</span>
<span class="nc" id="L305">            Logger.getLogger(GestionEtdIHM.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L306">            JOptionPane.showMessageDialog(this, &quot;Erreur de connexion au serveur.&quot;, &quot;Erreur&quot;, JOptionPane.ERROR_MESSAGE);}</span>
<span class="nc" id="L307">    }//GEN-LAST:event_btnAfficherParClasseActionPerformed</span>

    private void cmbClassActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbClassActionPerformed
        // TODO add your handling code here:
<span class="nc" id="L311">    }//GEN-LAST:event_cmbClassActionPerformed</span>

    private void btnImprimerActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImprimerActionPerformed
 try {
        ArrayList&lt;Etudiant&gt; etudiants;
        String titre;
        
        // Vérifier si une classe est sélectionnée
<span class="nc bnc" id="L319" title="All 2 branches missed.">        if (cmbClass.getSelectedIndex() &gt; 0) {</span>
<span class="nc" id="L320">            int idClasse = classes.get(cmbClass.getSelectedIndex()).getIdClasse();</span>
<span class="nc" id="L321">            etudiants = client.afficherEtudiantsParClasse(idClasse);</span>
<span class="nc" id="L322">            titre = &quot;Liste des étudiants - Classe: &quot; + cmbClass.getSelectedItem().toString();</span>
<span class="nc" id="L323">        } else {</span>
<span class="nc" id="L324">            etudiants = client.afficherEtudiants();</span>
<span class="nc" id="L325">            titre = &quot;Liste complète des étudiants&quot;;</span>
        }
        
<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (etudiants.isEmpty()) {</span>
<span class="nc" id="L329">            JOptionPane.showMessageDialog(this, </span>
                &quot;Aucun étudiant à imprimer&quot;, 
                &quot;Information&quot;, JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L332">            return;</span>
        }
        
<span class="nc" id="L335">        genererListePDF(etudiants, titre);</span>
        
<span class="nc" id="L337">    } catch (RemoteException ex) {</span>
<span class="nc" id="L338">        Logger.getLogger(EtdListeIHM.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L339">        JOptionPane.showMessageDialog(this, </span>
            &quot;Erreur de connexion au serveur&quot;, 
            &quot;Erreur&quot;, JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L342">    }    }//GEN-LAST:event_btnImprimerActionPerformed</span>

    private void txtSearchKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSearchKeyReleased
        try {
<span class="nc" id="L346">            ArrayList&lt;Etudiant&gt; etudiants = client.searchETD(txtSearch.getText().trim());</span>
<span class="nc" id="L347">            DefaultTableModel model = (DefaultTableModel) table.getModel();</span>
<span class="nc" id="L348">            model.setRowCount(0); // Effacer les anciennes données</span>

<span class="nc bnc" id="L350" title="All 2 branches missed.">            for (Etudiant etudiant : etudiants) {</span>
<span class="nc" id="L351">                Object[] row = {</span>
<span class="nc" id="L352">                    etudiant.getId(),</span>
<span class="nc" id="L353">                    etudiant.getNom(),</span>
<span class="nc" id="L354">                    etudiant.getPrenom(),</span>
<span class="nc" id="L355">                    etudiant.getEmail(),</span>
<span class="nc" id="L356">                    etudiant.getNomFiliere(), // Assurez-vous d'avoir ces getters dans votre classe Etudiant</span>
<span class="nc" id="L357">                    etudiant.getNomClasse()  // Assurez-vous d'avoir ces getters dans votre classe Etudiant</span>
                };
<span class="nc" id="L359">                model.addRow(row);</span>
<span class="nc" id="L360">            }</span>
<span class="nc" id="L361">        } catch (RemoteException ex) {</span>
<span class="nc" id="L362">            Logger.getLogger(GestionEtdIHM.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L363">            javax.swing.JOptionPane.showMessageDialog(this, &quot;Erreur de récupération des étudiants.&quot;, &quot;Erreur&quot;, javax.swing.JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L364">        }</span>
<span class="nc" id="L365">    }//GEN-LAST:event_txtSearchKeyReleased</span>

    
    private void txtSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSearchActionPerformed
        // TODO add your handling code here:
<span class="nc" id="L370">    }//GEN-LAST:event_txtSearchActionPerformed</span>

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        try {
<span class="nc" id="L374">            this.dispose();</span>
<span class="nc" id="L375">            new etdManager().setVisible(true);</span>
<span class="nc" id="L376">        } catch (Exception e) {</span>
<span class="nc" id="L377">            e.printStackTrace();</span>
<span class="nc" id="L378">        }</span>
<span class="nc" id="L379">    }//GEN-LAST:event_jButton1ActionPerformed</span>
private void genererListePDF(ArrayList&lt;Etudiant&gt; etudiants, String titre) {
<span class="nc" id="L381">    Document document = new Document(PageSize.A4.rotate()); // Format paysage pour plus d'espace</span>
    try {
        // Créer le dossier de sauvegarde
<span class="nc" id="L384">        new File(&quot;listes_etudiants&quot;).mkdir();</span>
        
        // Nom du fichier avec date/heure
<span class="nc" id="L387">        String timestamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;).format(new Date());</span>
<span class="nc" id="L388">        String filename = &quot;listes_etudiants/ListeEtudiants_&quot; + timestamp + &quot;.pdf&quot;;</span>
        
<span class="nc" id="L390">        PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filename));</span>
<span class="nc" id="L391">        document.open();</span>
        
        // Police personnalisée
<span class="nc" id="L394">        Font fontTitre = new Font(Font.FontFamily.HELVETICA, 18, Font.BOLD, BaseColor.DARK_GRAY);</span>
<span class="nc" id="L395">        Font fontHeader = new Font(Font.FontFamily.HELVETICA, 12, Font.BOLD, BaseColor.WHITE);</span>
<span class="nc" id="L396">        Font fontTexte = new Font(Font.FontFamily.HELVETICA, 10, Font.NORMAL, BaseColor.BLACK);</span>
        
        // En-tête
<span class="nc" id="L399">        Paragraph header = new Paragraph(titre, fontTitre);</span>
<span class="nc" id="L400">        header.setAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L401">        header.setSpacingAfter(20f);</span>
<span class="nc" id="L402">        document.add(header);</span>
        
        // Informations sur la génération
<span class="nc" id="L405">        Paragraph info = new Paragraph(</span>
<span class="nc" id="L406">            &quot;Généré le: &quot; + new SimpleDateFormat(&quot;dd/MM/yyyy à HH:mm&quot;).format(new Date()) + </span>
<span class="nc" id="L407">            &quot;\nNombre d'étudiants: &quot; + etudiants.size(), </span>
            new Font(Font.FontFamily.HELVETICA, 10, Font.ITALIC));
<span class="nc" id="L409">        info.setAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L410">        info.setSpacingAfter(15f);</span>
<span class="nc" id="L411">        document.add(info);</span>
        
        // Création du tableau
<span class="nc" id="L414">        PdfPTable table = new PdfPTable(6); // 6 colonnes</span>
<span class="nc" id="L415">        table.setWidthPercentage(100);</span>
<span class="nc" id="L416">        table.setSpacingBefore(10f);</span>
        
        // En-têtes du tableau
<span class="nc" id="L419">        String[] headers = {&quot;ID&quot;, &quot;Nom&quot;, &quot;Prénom&quot;, &quot;Email&quot;, &quot;Filière&quot;, &quot;Classe&quot;};</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">        for (String headerText : headers) {</span>
<span class="nc" id="L421">            PdfPCell cell = new PdfPCell(new Phrase(headerText, fontHeader));</span>
<span class="nc" id="L422">            cell.setBackgroundColor(new BaseColor(70, 130, 180)); // Bleu</span>
<span class="nc" id="L423">            cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L424">            cell.setPadding(5);</span>
<span class="nc" id="L425">            table.addCell(cell);</span>
        }
        
        // Remplissage des données
<span class="nc bnc" id="L429" title="All 2 branches missed.">        for (Etudiant etudiant : etudiants) {</span>
<span class="nc" id="L430">            addCell(table, String.valueOf(etudiant.getId()), fontTexte);</span>
<span class="nc" id="L431">            addCell(table, etudiant.getNom(), fontTexte);</span>
<span class="nc" id="L432">            addCell(table, etudiant.getPrenom(), fontTexte);</span>
<span class="nc" id="L433">            addCell(table, etudiant.getEmail(), fontTexte);</span>
<span class="nc" id="L434">            addCell(table, etudiant.getNomFiliere(), fontTexte);</span>
<span class="nc" id="L435">            addCell(table, etudiant.getNomClasse(), fontTexte);</span>
<span class="nc" id="L436">        }</span>
        
<span class="nc" id="L438">        document.add(table);</span>
        
        // Pied de page
<span class="nc" id="L441">        Paragraph footer = new Paragraph(</span>
            &quot;Université XYZ - Service Scolarité&quot;, 
            new Font(Font.FontFamily.HELVETICA, 9, Font.ITALIC));
<span class="nc" id="L444">        footer.setAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L445">        footer.setSpacingBefore(20f);</span>
<span class="nc" id="L446">        document.add(footer);</span>
        
<span class="nc" id="L448">        JOptionPane.showMessageDialog(this, </span>
<span class="nc" id="L449">            &quot;Liste générée avec succès:\n&quot; + new File(filename).getAbsolutePath(),</span>
            &quot;Succès&quot;, JOptionPane.INFORMATION_MESSAGE);
        
<span class="nc" id="L452">    } catch (Exception e) {</span>
<span class="nc" id="L453">        JOptionPane.showMessageDialog(this, </span>
<span class="nc" id="L454">            &quot;Erreur lors de la génération du PDF: &quot; + e.getMessage(),</span>
            &quot;Erreur&quot;, JOptionPane.ERROR_MESSAGE);
    } finally {
<span class="nc bnc" id="L457" title="All 2 branches missed.">        if (document.isOpen()) {</span>
<span class="nc" id="L458">            document.close();</span>
        }
    }
<span class="nc" id="L461">}</span>
private void addCell(PdfPTable table, String text, Font font) {
<span class="nc" id="L463">    PdfPCell cell = new PdfPCell(new Phrase(text, font));</span>
<span class="nc" id="L464">    cell.setPadding(5);</span>
<span class="nc" id="L465">    table.addCell(cell);</span>
<span class="nc" id="L466">}</span>
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //&lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot; Look and feel setting code (optional) &quot;&gt;
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
<span class="nc bnc" id="L477" title="All 2 branches missed.">            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">                if (&quot;Nimbus&quot;.equals(info.getName())) {</span>
<span class="nc" id="L479">                    javax.swing.UIManager.setLookAndFeel(info.getClassName());</span>
<span class="nc" id="L480">                    break;</span>
                }
            }
<span class="nc" id="L483">        } catch (ClassNotFoundException ex) {</span>
<span class="nc" id="L484">            java.util.logging.Logger.getLogger(EtdListeIHM.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);</span>
<span class="nc" id="L485">        } catch (InstantiationException ex) {</span>
<span class="nc" id="L486">            java.util.logging.Logger.getLogger(EtdListeIHM.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);</span>
<span class="nc" id="L487">        } catch (IllegalAccessException ex) {</span>
<span class="nc" id="L488">            java.util.logging.Logger.getLogger(EtdListeIHM.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);</span>
<span class="nc" id="L489">        } catch (javax.swing.UnsupportedLookAndFeelException ex) {</span>
<span class="nc" id="L490">            java.util.logging.Logger.getLogger(EtdListeIHM.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);</span>
<span class="nc" id="L491">        }</span>
        //&lt;/editor-fold&gt;

        /* Create and display the form */
<span class="nc" id="L495">        java.awt.EventQueue.invokeLater(new Runnable() {</span>
            public void run() {
                try {
<span class="nc" id="L498">                    new EtdListeIHM().setVisible(true);</span>
<span class="nc" id="L499">                } catch (RemoteException ex) {</span>
<span class="nc" id="L500">                    Logger.getLogger(EtdListeIHM.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L501">                }</span>
<span class="nc" id="L502">            }</span>
        });
<span class="nc" id="L504">    }</span>

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAfficherParClasse;
    private javax.swing.JButton btnImprimer;
    private javax.swing.JComboBox&lt;String&gt; cmbClass;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable table;
    private javax.swing.JTextField txtSearch;
    // End of variables declaration//GEN-END:variables
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>